justicia <- read.csv('Data/justicia.csv')
View(justicia)
justicia <- read.csv('Data/justicia.csv', encoding = 'UTF-8')
View(justicia)
justicia <- read.csv('Data/justicia.csv', encoding = 'UTF-8') %>%
select(-X)
justicia <- read.csv('Data/justicia.csv', encoding = 'UTF-8') %>%
select(-X)
library(tidyverse)
justicia <- read.csv('Data/justicia.csv', encoding = 'UTF-8') %>%
select(-X)
View(justicia)
write_rds(justicia, 'Data/justicia.rds')
arbol_justicia <- read.csv('Data/arbol_justicia.csv', encoding = 'UTF-8')
View(arbol_justicia)
arbol_justicia <- read.csv('Data/arbol_justicia.csv', encoding = 'UTF-8') %>%
select(-X)
arbol_write_rds(justicia, 'Data/arbol_justicia.rds')
write_rds(justicia, 'Data/arbol_justicia.rds')
write_rds(arbol_justicia, 'Data/arbol_justicia.rds')
cluster_relaciones <- read.csv('Data/cluster_relaciones.csv', encoding = 'UTF-8') %>%
select(-X)
write_rds(cluster_relaciones, 'Data/cluster_relaciones.rds')
.csv', encoding = 'UTF-8') %>%
select(-X)
write_rds(cluster_violencia, 'Data/cluster_violencia.
cluster_violencia <- read.csv('Data/cluster_violencia.csv', encoding = 'UTF-8')
cluster_violencia <- read.csv('Data/cluster_violencia.csv', encoding = 'UTF-8')
View(cluster_violencia)
cluster_violencia <- read.csv('Data/cluster_violencia.csv', encoding = 'UTF-8') %>%
select(-X)
write_rds(cluster_violencia, 'Data/cluster_violencia.rds')
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
justicia <- readRDS('Data/justicia.rds')
View(justicia)
edades <- justicia %>%
select(`EDAD_ACUSADO/A.AL.MOMENTO.DEL.HECHO`,EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO) %>%
filter(`EDAD_ACUSADO/A.AL.MOMENTO.DEL.HECHO`>0,EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO>0) %>%
rename(EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO=`EDAD_ACUSADO/A.AL.MOMENTO.DEL.HECHO`,
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO=EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO)
edades <- justicia %>%
select(EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO,EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO) %>%
filter(EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO>0,EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO>0) %>%
rename(`EDAD ACUSADO`=EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO,
`EDAD DENUNCIANTE`=EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO)
g5 <- ggplot(edades, aes(x=`EDAD ACUSADO`, y=`EDAD DENUNCIANTE`)) +
geom_point(aes()) +
scale_x_continuous(n.breaks = 10) +
scale_y_continuous(n.breaks = 10) +
labs(x = "Edad del acusado",
y = "Edad del denunciante") +
geom_smooth(method = 'lm') +
geom_hline(yintercept=mean(edades$`EDAD DENUNCIANTE`), color='#15921a') +
geom_vline(xintercept=mean(edades$`EDAD ACUSADO`), color='#15921a')
ggplotly(g5)
arbol_justicia <- readRDS('Data/cluster_justicia.rds')
arbol_justicia <- readRDS('Data/cluster_relaciones.rds')
View(arbol_justicia)
cluster_justicia <- read.csv('Data/cluster_justicia.csv', encoding = 'UTF-8')
cluster_justicia <- read.csv('Data/csv/cluster_justicia.csv', encoding = 'UTF-8')
View(cluster_justicia)
library(tidyverse)
cluster_justicia <- read.csv('Data/csv/cluster_justicia.csv', encoding = 'UTF-8') %>%
select(-X)
write_rds('Data/cluster_justicia.rds')
write_rds(cluster_justicia,'Data/cluster_justicia.rds')
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
justicia <- readRDS('Data/justicia.rds')
View(justicia)
edad_acu <- justicia %>%
filter(! is.na(EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO)) %>%
rename(Edad=EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO,Genero=GENERO_ACUSADO.A) %>%
filter(Genero=='Masculino'|Genero=='Femenino')
g3 <- ggplot(edad_acu,aes(x=Genero, fill=Edad)) +
geom_bar(position = 'Fill') +
labs(x = "Género de los acusados", y = "Resoluciones") +
scale_fill_manual(values=brewer.pal(n = 9, name = "Set2")) +
scale_y_continuous(labels=scales::percent)
library(RColorBrewer)
g3 <- ggplot(edad_acu,aes(x=Genero, fill=Edad)) +
geom_bar(position = 'Fill') +
labs(x = "Género de los acusados", y = "Resoluciones") +
scale_fill_manual(values=brewer.pal(n = 9, name = "Set2")) +
scale_y_continuous(labels=scales::percent)
ggplotly(g3)
library(tidyverse)
library(funModeling)
library(funModeling)
library(plotly)
library(treemapify)
library(glue)
library(scales)
library(RColorBrewer)
library(wordcloud)
library(wordcloud2)
library(rpart)
library(rattle)
g3 <- ggplot(edad_acu,aes(x=Genero, fill=Edad)) +
geom_bar(position = 'Fill') +
labs(x = "Género de los acusados", y = "Resoluciones") +
scale_fill_manual(values=brewer.pal(n = 9, name = "Set2")) +
scale_y_continuous(labels=scales::percent)
g3 <- ggplot(edad_acu,aes(x=Genero, fill=Edad)) +
geom_bar(position = 'Fill') +
labs(x = "Género de los acusados", y = "Resoluciones") +
scale_fill_manual(values=brewer.pal(n = 8, name = "Set2")) +
scale_y_continuous(labels=scales::percent)
ggplotly(g3)
View(edad_acu)
View(justicia)
readRDS('Data/justicia.rds')
justicia <- readRDS('Data/justicia.rds')
View(justicia)
library(tidyverse)
library(funModeling)
justicia <- justicia %>%
mutate(`Edad Acusado` = case_when(
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<18 ~ "Menor de edad",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<25 ~ "18 a 24",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<35 ~ "25 a 34",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<45 ~ "35 a 44",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<55 ~ "45 a 54",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<99 ~ "55 y +"
))
freq(justicia$`Edad Acusado`)
justicia <- justicia %>%
mutate(`Edad Denunciante` = case_when(
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<18 ~ "Menor de edad",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<25 ~ "18 a 24",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<35 ~ "25 a 34",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<45 ~ "35 a 44",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<55 ~ "45 a 54",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<99 ~ "55 y +"
))
freq(justicia$`Edad Denunciante`)
write_rds(justicia, 'Data/justicia.rds')
edad_acu <- justicia %>%
filter(! is.na(EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO)) %>%
rename(Edad=`Edad Acusado`,Genero=GENERO_ACUSADO.A) %>%
filter(Genero=='Masculino'|Genero=='Femenino')
g3 <- ggplot(edad_acu,aes(x=Genero, fill=Edad)) +
geom_bar(position = 'Fill') +
labs(x = "Género de los acusados", y = "Resoluciones") +
scale_fill_manual(values=brewer.pal(n = 8, name = "Set2")) +
scale_y_continuous(labels=scales::percent)
ggplotly(g3)
justicia <- readRDS('Data/justicia.rds')
justicia <- justicia %>%
mutate(`Edad Acusado` = case_when(
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<18 ~ "Menor de edad",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<25 ~ "18 a 24",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<35 ~ "25 a 34",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<45 ~ "35 a 44",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<55 ~ "45 a 54",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<65 ~ "55 a 64",
EDAD_ACUSADO.A.AL.MOMENTO.DEL.HECHO<99 ~ "65 y +"
))
justicia <- justicia %>%
mutate(`Edad Denunciante` = case_when(
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<18 ~ "Menor de edad",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<25 ~ "18 a 24",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<35 ~ "25 a 34",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<45 ~ "35 a 44",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<55 ~ "45 a 54",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<65 ~ "55 a 64",
EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO<99 ~ "65 y +"
))
write_rds(justicia, 'Data/justicia.rds')
edad_den <- justicia %>%
filter(! is.na(EDAD_DENUNCIANTE_AL_MOMENTO_DEL_HECHO)) %>%
rename(Edad=`Edad Denunciante`,Genero=`GENERO_DENUNCIANTE`,) %>%
filter(Genero=='Masculino'|Genero=='Femenino')
g4 <- ggplot(edad_den,aes(x=Genero, fill=Edad)) +
geom_bar(position = 'Fill') +
labs(x = "Género de los denunciantes", y = "Resoluciones") +
scale_fill_manual(values=brewer.pal(n = 9, name = "Set2")) +
scale_y_continuous(labels=scales::percent)
ggplotly(g4)
View(justicia)
